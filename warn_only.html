
            <html>
                <head>
                    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
                    <style>body{ margin:0; background:whitesmoke; }</style>
                    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>

                    <style>
                        code {
                            width: 600px;
                        }
                        td:nth-child(6),td:nth-child(1) {
                            font-size: 10pt;
                        }
                        .red {
                            color: red;
                        }
                        .none {
                            display: none;
                        }
                        .controls {
                            text-align: center;
                            font-size: 1.5em;
                            padding: 15px;
                        }
                        .controls span {
                            padding-left: 20px;
                        }
                    </style>
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/go.min.js"></script>
                    <script>
                    function main() {
                        function selectFilter(ev) {
                            let table = document.getElementsByTagName("table")[0];
                            let severitySelect = document.getElementById("severity");
                            let impactSelect = document.getElementById("impact");
                            let severity = severitySelect.value.toUpperCase();
                            let impact = impactSelect.value.toUpperCase();
                            tr = table.getElementsByTagName("tr");
                            for (i = 0; i < tr.length; i++) {
                                let div = tr[i].getElementsByClassName("data")[0];
                                if ( ! div) {
                                    continue;
                                }
                                //console.log("here dataset seve", div.dataset.severity.toUpperCase(), "dataset impa", div.dataset.impact.toUpperCase(), "seve", severity, "impact", impact );
                                if ( ( div.dataset.severity.toUpperCase() != severity && severity != "ALL" ) || ( div.dataset.impact.toUpperCase() != impact && impact != "ALL" ) ) {
                                    if ( ! tr[i].classList.contains("none") ) {
                                        //console.log("adding add 'none'");
                                        tr[i].classList.add("none");
                                    }
                                } else {
                                    tr[i].classList.remove("none");
                                }
                            }
                        }

                        function filterText(ev) {
                                var input, filter, tr, txtValue;
                                input = document.getElementById("text_filter");
                                filter = input.value.toUpperCase();
                                let table = document.getElementsByTagName("table")[0];
                                tr = table.getElementsByTagName("tr");
                                for (let i = 0; i < tr.length; i++) {
                                    let td = tr[i].getElementsByTagName("td");
                                    let txt = []
                                    for (let td_idx = 0; td_idx < td.length; td_idx++) {
                                        let t = td[td_idx];
                                        console.log("HERE", t);
                                        if (!t) return;
                                        txtValue = t.textContent || t.innerText;
                                        txt.push(txtValue.toUpperCase())
                                    }
                                    if (txt.some( (t) => t.includes(filter)) ) {
                                        tr[i].classList.remove("none");
                                    } else {
                                        tr[i].classList.add("none");
                                    }
                                }
                        }
                        document.getElementById("text_filter").addEventListener("keyup", filterText);
                        document.getElementById("impact").addEventListener("change", selectFilter);
                        document.getElementById("severity").addEventListener("change", selectFilter);
                        selectFilter();
                    }
                    </script
                </head>
<!-- 
{
  "meta": {
    "commit_author": null,
    "commit_branch": null,
    "commit_date": null,
    "commit_sha": null,
    "commit_title": null,
    "filtered_message_count": 90,
    "mr_iid": null,
    "mr_source_branch": null,
    "mr_target_branch": null,
    "mr_title": null,
    "pipeline_date": null,
    "pipeline_job_date": null,
    "pipeline_job_image": null,
    "pipeline_job_name": null,
    "pipeline_job_stage": null,
    "pipeline_job_started_by_email": null,
    "pipeline_job_started_by_id": null,
    "pipeline_job_started_by_login": null,
    "pipeline_job_started_by_name": null,
    "pipeline_job_url": null,
    "pipeline_project_group": null,
    "pipeline_project_group_root": null,
    "pipeline_project_name": null,
    "pipeline_project_path": null,
    "pipeline_project_path_slug": null,
    "pipeline_project_url": null,
    "pipeline_server_url": null,
    "pipeline_url": null,
    "report_date": "2023-08-21 11:55:39.691428",
    "report_from_ci": false,
    "total_message_count": 90
  }
}
-->
                <body>
                <div class="controls">
                <input type="text" id="text_filter" placeholder="Search..." title="Type in a name">
                <span>IMPACT</span>
                <select name="impact" id="impact">
                    <option value="all" selected="selected" >All</option>
                    <option value="high" >High</option>
                    <option value="warning">Warning</option>
                    <option value="low">Low</option>
                </select>
                <span>SEVERITY</span>
                <select name="severity" id="severity">
                    <option value="all" selected="selected" >All</option>
                    <option value="error">Error</option>
                    <option value="high" >High</option>
                    <option value="warning">Warning</option>
                    <option value="low">Low</option>
                </select>
                </div>
            <table id="info-table" class="table table-bordered table-hover"><thead><tr><th>code</th><th>impact / severity  / confidence</th><th>file</th><th>pos</th><th>line</th><th>message</th><th>snippet</th></tr></thead><tbody><tr><td>generic.secrets.security.detected-generic-secret.detected-generic-secret</td><td><div class="data" data-impact="MEDIUM" data-severity="ERROR"><span class='red'>MEDIUM</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/.env#L177">.env</a></td><td>5</td><td>177</td><td>Generic Secret detected</td><td><pre><code class="">173 LS_REMEMBER_ME_JWT_ENCRYPTION_KEY=ask_for_it
174 
175 ###> symfony/framework-bundle ###
176 APP_ENV=dev
177 APP_SECRET=537edd5a95922932266023e992899f4d
178 ###< symfony/framework-bundle ###
179 
180 ###> symfony/messenger ###
181 # Choose one of the transports below
182 # MESSENGER_TRANSPORT_DSN=amqp://guest:guest@localhost:5672/%2f/messages
183 # MESSENGER_TRANSPORT_DSN=doctrine://default?auto_setup=0
</code></pre></td></tr><tr><td>yaml.github-actions.security.third-party-action-not-pinned-to-commit-sha.third-party-action-not-pinned-to-commit-sha</td><td><div class="data" data-impact="LOW" data-severity="WARNING"><span class='red'>LOW</span> / WARNING / HIGH</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/.github/workflows/sonar.yaml#L13">.github/workflows/sonar.yaml</a></td><td>9</td><td>13</td><td>An action sourced from a third-party repository on GitHub is not pinned to a full length commit SHA. Pinning an action to a full length commit SHA is currently the only way to use an action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload.</td><td><pre><code class="language-yaml">9     steps:
10       - uses: actions/checkout@v2
11         with:
12           fetch-depth: 0  # Shallow clones should be disabled for a better relevancy of analysis
13       - uses: sonarsource/sonarqube-scan-action@master
14         env:
15           SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
16           SONAR_HOST_URL: ${{ secrets.SONAR_HOST_URL }}
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.services.yaml#L13">docker-compose.services.yaml</a></td><td>3</td><td>13</td><td>Service 'da-php' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">9   &php-image
10     docker-registry.pxfd.tech/php-fpm:8.2.2-fpm-bullseye_1
11 
12 services:
13   da-php:
14     container_name: da-php
15     image: *php-image
16     volumes:
17       - .:/srv/www:delegated
18     environment:
19       - USER_ID=${USER_ID:-1000}
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.services.yaml#L13">docker-compose.services.yaml</a></td><td>3</td><td>13</td><td>Service 'da-php' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">9   &php-image
10     docker-registry.pxfd.tech/php-fpm:8.2.2-fpm-bullseye_1
11 
12 services:
13   da-php:
14     container_name: da-php
15     image: *php-image
16     volumes:
17       - .:/srv/www:delegated
18     environment:
19       - USER_ID=${USER_ID:-1000}
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.services.yaml#L33">docker-compose.services.yaml</a></td><td>3</td><td>33</td><td>Service 'da-mysql' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">29       - PHP_DEV_BLACKFIRE_AGENT_SOCKET=tcp://da-blackfire:8307
30       - XDEBUG_CONFIG=remote_host=debug-pc.docker.pxfd.tech idekey=xdebug
31     restart: always
32 
33   da-mysql:
34     container_name: da-mysql
35     image: mysql:8.0
36     volumes:
37       - ~/databases/diggysadventure:/var/lib/mysql
38       - ./docker-compose/mysql/my.user.cnf:/etc/mysql/conf.d/my.user.cnf
39     environment:
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.services.yaml#L33">docker-compose.services.yaml</a></td><td>3</td><td>33</td><td>Service 'da-mysql' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">29       - PHP_DEV_BLACKFIRE_AGENT_SOCKET=tcp://da-blackfire:8307
30       - XDEBUG_CONFIG=remote_host=debug-pc.docker.pxfd.tech idekey=xdebug
31     restart: always
32 
33   da-mysql:
34     container_name: da-mysql
35     image: mysql:8.0
36     volumes:
37       - ~/databases/diggysadventure:/var/lib/mysql
38       - ./docker-compose/mysql/my.user.cnf:/etc/mysql/conf.d/my.user.cnf
39     environment:
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.services.yaml#L43">docker-compose.services.yaml</a></td><td>3</td><td>43</td><td>Service 'da-redis-1' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">39     environment:
40       MYSQL_ROOT_PASSWORD: root
41     restart: always
42 
43   da-redis-1:
44     container_name: da-redis-1
45     image: redis:6
46     labels:
47       - da-redis
48     volumes:
49       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.services.yaml#L43">docker-compose.services.yaml</a></td><td>3</td><td>43</td><td>Service 'da-redis-1' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">39     environment:
40       MYSQL_ROOT_PASSWORD: root
41     restart: always
42 
43   da-redis-1:
44     container_name: da-redis-1
45     image: redis:6
46     labels:
47       - da-redis
48     volumes:
49       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.services.yaml#L53">docker-compose.services.yaml</a></td><td>3</td><td>53</td><td>Service 'da-redis-2' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">49       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
50     command: redis-server /usr/local/etc/redis/redis.conf
51     restart: always
52 
53   da-redis-2:
54     container_name: da-redis-2
55     image: redis:6
56     labels:
57       - da-redis
58     volumes:
59       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.services.yaml#L53">docker-compose.services.yaml</a></td><td>3</td><td>53</td><td>Service 'da-redis-2' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">49       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
50     command: redis-server /usr/local/etc/redis/redis.conf
51     restart: always
52 
53   da-redis-2:
54     container_name: da-redis-2
55     image: redis:6
56     labels:
57       - da-redis
58     volumes:
59       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.services.yaml#L63">docker-compose.services.yaml</a></td><td>3</td><td>63</td><td>Service 'da-redis-3' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">59       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
60     command: redis-server /usr/local/etc/redis/redis.conf
61     restart: always
62 
63   da-redis-3:
64     container_name: da-redis-3
65     image: redis:6
66     labels:
67       - da-redis
68     volumes:
69       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.services.yaml#L63">docker-compose.services.yaml</a></td><td>3</td><td>63</td><td>Service 'da-redis-3' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">59       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
60     command: redis-server /usr/local/etc/redis/redis.conf
61     restart: always
62 
63   da-redis-3:
64     container_name: da-redis-3
65     image: redis:6
66     labels:
67       - da-redis
68     volumes:
69       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.services.yaml#L73">docker-compose.services.yaml</a></td><td>3</td><td>73</td><td>Service 'da-redis-cluster-creator' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">69       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
70     command: redis-server /usr/local/etc/redis/redis.conf
71     restart: always
72 
73   da-redis-cluster-creator:
74     container_name: da-redis-cluster-creator
75     image: docker
76     volumes:
77       - /var/run/docker.sock:/var/run/docker.sock
78     command: |
79       sh -c "
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.services.yaml#L73">docker-compose.services.yaml</a></td><td>3</td><td>73</td><td>Service 'da-redis-cluster-creator' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">69       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
70     command: redis-server /usr/local/etc/redis/redis.conf
71     restart: always
72 
73   da-redis-cluster-creator:
74     container_name: da-redis-cluster-creator
75     image: docker
76     volumes:
77       - /var/run/docker.sock:/var/run/docker.sock
78     command: |
79       sh -c "
</code></pre></td></tr><tr><td>yaml.docker-compose.security.exposing-docker-socket-volume.exposing-docker-socket-volume</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.services.yaml#L76">docker-compose.services.yaml</a></td><td>5</td><td>76</td><td>Exposing host's Docker socket to containers via a volume. The owner of this socket is root. Giving someone access to it is equivalent to giving unrestricted root access to your host. Remove 'docker.sock' from volumes to prevent this.</td><td><pre><code class="language-yaml">72 
73   da-redis-cluster-creator:
74     container_name: da-redis-cluster-creator
75     image: docker
76     volumes:
77       - /var/run/docker.sock:/var/run/docker.sock
78     command: |
79       sh -c "
80         sleep 2
81         cluster_hosts=
82         docker ps -q -f label=da-redis |
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L123">docker-compose.yaml</a></td><td>3</td><td>123</td><td>Service 'da-composer' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">119     depends_on:
120       - da-mysql
121     restart: always
122 
123   da-composer:
124     container_name: da-composer
125     image: *php-image
126     volumes:
127       - .:/srv/www:delegated
128       - ~/.composer:/var/www/.composer
129       - ~/.bash_history:/var/www/miner/.bash_history
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L123">docker-compose.yaml</a></td><td>3</td><td>123</td><td>Service 'da-composer' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">119     depends_on:
120       - da-mysql
121     restart: always
122 
123   da-composer:
124     container_name: da-composer
125     image: *php-image
126     volumes:
127       - .:/srv/www:delegated
128       - ~/.composer:/var/www/.composer
129       - ~/.bash_history:/var/www/miner/.bash_history
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L13">docker-compose.yaml</a></td><td>3</td><td>13</td><td>Service 'da' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">9   &php-image
10   docker-registry.pxfd.tech/php-fpm:8.2.2-fpm-bullseye_1
11 
12 services:
13   da:
14     container_name: da
15     image: nginx:latest
16     volumes:
17       - .:/srv/www:delegated
18       - ./docker-compose/nginx/nginx.conf:/etc/nginx/nginx.conf
19       - ./docker-compose/nginx/certs:/etc/nginx/certs
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L13">docker-compose.yaml</a></td><td>3</td><td>13</td><td>Service 'da' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">9   &php-image
10   docker-registry.pxfd.tech/php-fpm:8.2.2-fpm-bullseye_1
11 
12 services:
13   da:
14     container_name: da
15     image: nginx:latest
16     volumes:
17       - .:/srv/www:delegated
18       - ./docker-compose/nginx/nginx.conf:/etc/nginx/nginx.conf
19       - ./docker-compose/nginx/certs:/etc/nginx/certs
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L143">docker-compose.yaml</a></td><td>3</td><td>143</td><td>Service 'da-mysql' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">139     env_file:
140       - .env.local
141     restart: always
142 
143   da-mysql:
144     container_name: da-mysql
145     image: mysql:8.0
146     volumes:
147       - ~/databases/diggysadventure:/var/lib/mysql
148       - ./docker-compose/mysql/my.user.cnf:/etc/mysql/conf.d/my.user.cnf
149     environment:
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L143">docker-compose.yaml</a></td><td>3</td><td>143</td><td>Service 'da-mysql' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">139     env_file:
140       - .env.local
141     restart: always
142 
143   da-mysql:
144     container_name: da-mysql
145     image: mysql:8.0
146     volumes:
147       - ~/databases/diggysadventure:/var/lib/mysql
148       - ./docker-compose/mysql/my.user.cnf:/etc/mysql/conf.d/my.user.cnf
149     environment:
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L153">docker-compose.yaml</a></td><td>3</td><td>153</td><td>Service 'da-phpmyadmin' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">149     environment:
150       MYSQL_ROOT_PASSWORD: root
151     restart: always
152 
153   da-phpmyadmin:
154     container_name: da-phpmyadmin
155     image: phpmyadmin/phpmyadmin
156     volumes:
157       - ./docker-compose/phpmyadmin/etc/config.user.inc.php:/etc/phpmyadmin/config.user.inc.php
158     environment:
159       PMA_HOST: da-mysql
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L153">docker-compose.yaml</a></td><td>3</td><td>153</td><td>Service 'da-phpmyadmin' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">149     environment:
150       MYSQL_ROOT_PASSWORD: root
151     restart: always
152 
153   da-phpmyadmin:
154     container_name: da-phpmyadmin
155     image: phpmyadmin/phpmyadmin
156     volumes:
157       - ./docker-compose/phpmyadmin/etc/config.user.inc.php:/etc/phpmyadmin/config.user.inc.php
158     environment:
159       PMA_HOST: da-mysql
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L165">docker-compose.yaml</a></td><td>3</td><td>165</td><td>Service 'da-redis-1' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">161       PMA_PASSWORD: root
162       UPLOAD_LIMIT: 2G
163     restart: always
164 
165   da-redis-1:
166     container_name: da-redis-1
167     image: redis:6
168     labels:
169       - da-redis
170     volumes:
171       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L165">docker-compose.yaml</a></td><td>3</td><td>165</td><td>Service 'da-redis-1' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">161       PMA_PASSWORD: root
162       UPLOAD_LIMIT: 2G
163     restart: always
164 
165   da-redis-1:
166     container_name: da-redis-1
167     image: redis:6
168     labels:
169       - da-redis
170     volumes:
171       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L175">docker-compose.yaml</a></td><td>3</td><td>175</td><td>Service 'da-redis-2' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">171       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
172     command: redis-server /usr/local/etc/redis/redis.conf
173     restart: always
174 
175   da-redis-2:
176     container_name: da-redis-2
177     image: redis:6
178     labels:
179       - da-redis
180     volumes:
181       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L175">docker-compose.yaml</a></td><td>3</td><td>175</td><td>Service 'da-redis-2' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">171       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
172     command: redis-server /usr/local/etc/redis/redis.conf
173     restart: always
174 
175   da-redis-2:
176     container_name: da-redis-2
177     image: redis:6
178     labels:
179       - da-redis
180     volumes:
181       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L185">docker-compose.yaml</a></td><td>3</td><td>185</td><td>Service 'da-redis-3' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">181       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
182     command: redis-server /usr/local/etc/redis/redis.conf
183     restart: always
184 
185   da-redis-3:
186     container_name: da-redis-3
187     image: redis:6
188     labels:
189       - da-redis
190     volumes:
191       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L185">docker-compose.yaml</a></td><td>3</td><td>185</td><td>Service 'da-redis-3' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">181       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
182     command: redis-server /usr/local/etc/redis/redis.conf
183     restart: always
184 
185   da-redis-3:
186     container_name: da-redis-3
187     image: redis:6
188     labels:
189       - da-redis
190     volumes:
191       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L195">docker-compose.yaml</a></td><td>3</td><td>195</td><td>Service 'da-redis-cluster-creator' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">191       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
192     command: redis-server /usr/local/etc/redis/redis.conf
193     restart: always
194 
195   da-redis-cluster-creator:
196     container_name: da-redis-cluster-creator
197     image: docker
198     volumes:
199       - /var/run/docker.sock:/var/run/docker.sock
200     command: |
201       sh -c "
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L195">docker-compose.yaml</a></td><td>3</td><td>195</td><td>Service 'da-redis-cluster-creator' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">191       - ./docker-compose/redis/redis.conf:/usr/local/etc/redis/redis.conf:ro
192     command: redis-server /usr/local/etc/redis/redis.conf
193     restart: always
194 
195   da-redis-cluster-creator:
196     container_name: da-redis-cluster-creator
197     image: docker
198     volumes:
199       - /var/run/docker.sock:/var/run/docker.sock
200     command: |
201       sh -c "
</code></pre></td></tr><tr><td>yaml.docker-compose.security.exposing-docker-socket-volume.exposing-docker-socket-volume</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L198">docker-compose.yaml</a></td><td>5</td><td>198</td><td>Exposing host's Docker socket to containers via a volume. The owner of this socket is root. Giving someone access to it is equivalent to giving unrestricted root access to your host. Remove 'docker.sock' from volumes to prevent this.</td><td><pre><code class="language-yaml">194 
195   da-redis-cluster-creator:
196     container_name: da-redis-cluster-creator
197     image: docker
198     volumes:
199       - /var/run/docker.sock:/var/run/docker.sock
200     command: |
201       sh -c "
202         sleep 2
203         cluster_hosts=
204         docker ps -q -f label=da-redis |
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L22">docker-compose.yaml</a></td><td>3</td><td>22</td><td>Service 'da-php' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">18       - ./docker-compose/nginx/nginx.conf:/etc/nginx/nginx.conf
19       - ./docker-compose/nginx/certs:/etc/nginx/certs
20     restart: always
21 
22   da-php:
23     container_name: da-php
24     image: *php-image
25     volumes:
26       - .:/srv/www:delegated
27       - ./../localization/CSV:/srv/www/localization_crowdin
28       - ./../webgl-build/:/srv/www/static/0/webgl_client
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L22">docker-compose.yaml</a></td><td>3</td><td>22</td><td>Service 'da-php' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">18       - ./docker-compose/nginx/nginx.conf:/etc/nginx/nginx.conf
19       - ./docker-compose/nginx/certs:/etc/nginx/certs
20     restart: always
21 
22   da-php:
23     container_name: da-php
24     image: *php-image
25     volumes:
26       - .:/srv/www:delegated
27       - ./../localization/CSV:/srv/www/localization_crowdin
28       - ./../webgl-build/:/srv/www/static/0/webgl_client
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L45">docker-compose.yaml</a></td><td>3</td><td>45</td><td>Service 'da-php-xdebug' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">41       - PHP_DEV_BLACKFIRE_AGENT_SOCKET=tcp://da-blackfire:8307
42       - XDEBUG_CONFIG=remote_host=debug-pc.docker.pxfd.tech idekey=xdebug
43     restart: always
44 
45   da-php-xdebug:
46     container_name: da-php-xdebug
47     image: *php-image
48     volumes:
49       - .:/srv/www:delegated
50       - ./../localization/CSV:/srv/www/localization_crowdin
51       - ./../webgl-build/:/srv/www/static/0/webgl_client
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L45">docker-compose.yaml</a></td><td>3</td><td>45</td><td>Service 'da-php-xdebug' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">41       - PHP_DEV_BLACKFIRE_AGENT_SOCKET=tcp://da-blackfire:8307
42       - XDEBUG_CONFIG=remote_host=debug-pc.docker.pxfd.tech idekey=xdebug
43     restart: always
44 
45   da-php-xdebug:
46     container_name: da-php-xdebug
47     image: *php-image
48     volumes:
49       - .:/srv/www:delegated
50       - ./../localization/CSV:/srv/www/localization_crowdin
51       - ./../webgl-build/:/srv/www/static/0/webgl_client
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L66">docker-compose.yaml</a></td><td>3</td><td>66</td><td>Service 'da-swoole' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">62       - PHP_DEV_XDEBUG=true
63       - PHP_DEV_XDEBUG_START_WITH_REQUEST=yes
64     restart: always
65 
66   da-swoole:
67     container_name: da-swoole
68     image: *php-image
69     volumes:
70       - .:/srv/www:delegated
71       - ./../localization/CSV:/srv/www/localization_crowdin
72       - ./../webgl-build/:/srv/www/static/0/webgl_client
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L66">docker-compose.yaml</a></td><td>3</td><td>66</td><td>Service 'da-swoole' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">62       - PHP_DEV_XDEBUG=true
63       - PHP_DEV_XDEBUG_START_WITH_REQUEST=yes
64     restart: always
65 
66   da-swoole:
67     container_name: da-swoole
68     image: *php-image
69     volumes:
70       - .:/srv/www:delegated
71       - ./../localization/CSV:/srv/www/localization_crowdin
72       - ./../webgl-build/:/srv/www/static/0/webgl_client
</code></pre></td></tr><tr><td>yaml.docker-compose.security.no-new-privileges.no-new-privileges</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L94">docker-compose.yaml</a></td><td>3</td><td>94</td><td>Service 'da-swoole-xdebug' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.</td><td><pre><code class="language-yaml">90     depends_on:
91       - da-mysql
92     restart: always
93 
94   da-swoole-xdebug:
95     container_name: da-swoole-xdebug
96     image: *php-image
97     volumes:
98       - .:/srv/www:delegated
99       - ./../localization/CSV:/srv/www/localization_crowdin
100       - ./../webgl-build/:/srv/www/static/0/webgl_client
</code></pre></td></tr><tr><td>yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose.yaml#L94">docker-compose.yaml</a></td><td>3</td><td>94</td><td>Service 'da-swoole-xdebug' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.</td><td><pre><code class="language-yaml">90     depends_on:
91       - da-mysql
92     restart: always
93 
94   da-swoole-xdebug:
95     container_name: da-swoole-xdebug
96     image: *php-image
97     volumes:
98       - .:/srv/www:delegated
99       - ./../localization/CSV:/srv/www/localization_crowdin
100       - ./../webgl-build/:/srv/www/static/0/webgl_client
</code></pre></td></tr><tr><td>generic.secrets.security.detected-private-key.detected-private-key</td><td><div class="data" data-impact="MEDIUM" data-severity="ERROR"><span class='red'>MEDIUM</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/docker-compose/nginx/certs/localhost.key#L1">docker-compose/nginx/certs/localhost.key</a></td><td>1</td><td>1</td><td>Private Key detected. This is a sensitive credential and should not be hardcoded here. Instead, store this in a separate, private file.</td><td><pre><code class="">2 MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDG2qSYHcYdQo/o
3 SyXSjayK2toS/+55ZCeVr2UL6bIrDL9pNyF2HqBEoGhccYXz0fpRd9oI/FTBcKoz
4 CMar4XGuh6DPKdhvYLgGeBZflUnrv2GK/wv2LHEdGEbVzmoIDN21cqiJDvIfimiQ
5 ByzrNlQqZAMYsMRrLte5iDlhhdHBxTbWTJD9elr7RfR9ccVFzcNBPjXsSxeop20n
6 xiU4uzRb4IKuJE7egJnstRligzO3gj4TKe9sPG/MJ4ey4LXJEeBOgB0dYA8XMPMM
7 3GOsxhjlyrW7heFqNaFjXdyhY0KwuhOOhZBM6HjK7nOC5Bnlvpa7WdLieHj6jb4B
8 BnzbAzeFAgMBAAECggEBAKcdtrfURdvvRYueJAIoaDolpKHVDnBcOFw2lAAH/WDq
9 jK5605c2M9CY0jvmeAGplOoEhGuKzBvpeE/9byGiDGz1tLKFY0xvBxkAsSTRDNef
10 9fTfVQkk3kbqURV8LGXpkiXcX0EYG2lgY3GvZhOii+c4N9X3MIs3Sbq1fiu0T8y8
11 WpXy/b0rd+YScY8IT6hA6jV29VNlmcs4TOMKAkWNtcz1UqfvwrZ4cox/U61efKct
12 6WKn0OkLfH/iQFaER51WJpGTb1AkOyEEiRbSR4Tw1DiWpsf9RSwVU1fnx3VyY5hj
</code></pre></td></tr><tr><td>javascript.browser.security.eval-detected.eval-detected</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/ie9.js#L6">public/miner/js/ie9.js</a></td><td>17424</td><td>6</td><td>Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.browser.security.eval-detected.eval-detected</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/ie9.js#L6">public/miner/js/ie9.js</a></td><td>19114</td><td>6</td><td>Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.browser.security.eval-detected.eval-detected</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/ie9.js#L6">public/miner/js/ie9.js</a></td><td>24790</td><td>6</td><td>Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.browser.security.eval-detected.eval-detected</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/ie9.js#L6">public/miner/js/ie9.js</a></td><td>41045</td><td>6</td><td>Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/ie9.js#L6">public/miner/js/ie9.js</a></td><td>2880</td><td>6</td><td>RegExp() called with a `k` function argument, this might allow an attacker to cause a Regular Expression Denial-of-Service (ReDoS) within your application as RegExP blocks the main thread. For this reason, it is recommended to use hardcoded regexes instead. If your regex is run on user-controlled input, consider performing input validation or use a regex checking/sanitization library such as https://www.npmjs.com/package/recheck to verify that the regex does not appear vulnerable to ReDoS.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/ie9.js#L6">public/miner/js/ie9.js</a></td><td>2880</td><td>6</td><td>RegExp() called with a `m` function argument, this might allow an attacker to cause a Regular Expression Denial-of-Service (ReDoS) within your application as RegExP blocks the main thread. For this reason, it is recommended to use hardcoded regexes instead. If your regex is run on user-controlled input, consider performing input validation or use a regex checking/sanitization library such as https://www.npmjs.com/package/recheck to verify that the regex does not appear vulnerable to ReDoS.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/ie9.js#L6">public/miner/js/ie9.js</a></td><td>7780</td><td>6</td><td>RegExp() called with a `g` function argument, this might allow an attacker to cause a Regular Expression Denial-of-Service (ReDoS) within your application as RegExP blocks the main thread. For this reason, it is recommended to use hardcoded regexes instead. If your regex is run on user-controlled input, consider performing input validation or use a regex checking/sanitization library such as https://www.npmjs.com/package/recheck to verify that the regex does not appear vulnerable to ReDoS.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/ie9.js#L6">public/miner/js/ie9.js</a></td><td>7780</td><td>6</td><td>RegExp() called with a `i` function argument, this might allow an attacker to cause a Regular Expression Denial-of-Service (ReDoS) within your application as RegExP blocks the main thread. For this reason, it is recommended to use hardcoded regexes instead. If your regex is run on user-controlled input, consider performing input validation or use a regex checking/sanitization library such as https://www.npmjs.com/package/recheck to verify that the regex does not appear vulnerable to ReDoS.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/ie9.js#L6">public/miner/js/ie9.js</a></td><td>41137</td><td>6</td><td>RegExp() called with a `N` function argument, this might allow an attacker to cause a Regular Expression Denial-of-Service (ReDoS) within your application as RegExP blocks the main thread. For this reason, it is recommended to use hardcoded regexes instead. If your regex is run on user-controlled input, consider performing input validation or use a regex checking/sanitization library such as https://www.npmjs.com/package/recheck to verify that the regex does not appear vulnerable to ReDoS.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.browser.security.insecure-document-method.insecure-document-method</td><td><div class="data" data-impact="LOW" data-severity="ERROR"><span class='red'>LOW</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/jquery/jquery.js#L16">public/miner/js/jquery/jquery.js</a></td><td>3767</td><td>16</td><td>User controlled data in methods like `innerHTML`, `outerHTML` or `document.write` is an anti-pattern that can lead to XSS vulnerabilities</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/jquery/jquery.js#L16">public/miner/js/jquery/jquery.js</a></td><td>5218</td><td>16</td><td>RegExp() called with a `a` function argument, this might allow an attacker to cause a Regular Expression Denial-of-Service (ReDoS) within your application as RegExP blocks the main thread. For this reason, it is recommended to use hardcoded regexes instead. If your regex is run on user-controlled input, consider performing input validation or use a regex checking/sanitization library such as https://www.npmjs.com/package/recheck to verify that the regex does not appear vulnerable to ReDoS.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/jquery/jquery.js#L16">public/miner/js/jquery/jquery.js</a></td><td>31564</td><td>16</td><td>RegExp() called with a `c` function argument, this might allow an attacker to cause a Regular Expression Denial-of-Service (ReDoS) within your application as RegExP blocks the main thread. For this reason, it is recommended to use hardcoded regexes instead. If your regex is run on user-controlled input, consider performing input validation or use a regex checking/sanitization library such as https://www.npmjs.com/package/recheck to verify that the regex does not appear vulnerable to ReDoS.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/jquery/jquery.js#L17">public/miner/js/jquery/jquery.js</a></td><td>203</td><td>17</td><td>RegExp() called with a `c` function argument, this might allow an attacker to cause a Regular Expression Denial-of-Service (ReDoS) within your application as RegExP blocks the main thread. For this reason, it is recommended to use hardcoded regexes instead. If your regex is run on user-controlled input, consider performing input validation or use a regex checking/sanitization library such as https://www.npmjs.com/package/recheck to verify that the regex does not appear vulnerable to ReDoS.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.lang.security.audit.prototype-pollution.prototype-pollution-loop.prototype-pollution-loop</td><td><div class="data" data-impact="LOW" data-severity="WARNING"><span class='red'>LOW</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/jquery/jquery.js#L17">public/miner/js/jquery/jquery.js</a></td><td>9242</td><td>17</td><td>Possibility of prototype polluting function detected. By adding or modifying attributes of an object prototype, it is possible to create attributes that exist on every object, or replace critical attributes with malicious ones. This can be problematic if the software depends on existence or non-existence of certain attributes, or uses pre-defined attributes of object prototype (such as hasOwnProperty, toString or valueOf). Possible mitigations might be: freezing the object prototype, using an object without prototypes (via Object.create(null) ), blocking modifications of attributes that resolve to object prototype, using Map instead of object.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.lang.security.audit.prototype-pollution.prototype-pollution-loop.prototype-pollution-loop</td><td><div class="data" data-impact="LOW" data-severity="WARNING"><span class='red'>LOW</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/jquery/jquery.js#L17">public/miner/js/jquery/jquery.js</a></td><td>9435</td><td>17</td><td>Possibility of prototype polluting function detected. By adding or modifying attributes of an object prototype, it is possible to create attributes that exist on every object, or replace critical attributes with malicious ones. This can be problematic if the software depends on existence or non-existence of certain attributes, or uses pre-defined attributes of object prototype (such as hasOwnProperty, toString or valueOf). Possible mitigations might be: freezing the object prototype, using an object without prototypes (via Object.create(null) ), blocking modifications of attributes that resolve to object prototype, using Map instead of object.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.lang.security.audit.prototype-pollution.prototype-pollution-loop.prototype-pollution-loop</td><td><div class="data" data-impact="LOW" data-severity="WARNING"><span class='red'>LOW</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/jquery/jquery.js#L17">public/miner/js/jquery/jquery.js</a></td><td>9533</td><td>17</td><td>Possibility of prototype polluting function detected. By adding or modifying attributes of an object prototype, it is possible to create attributes that exist on every object, or replace critical attributes with malicious ones. This can be problematic if the software depends on existence or non-existence of certain attributes, or uses pre-defined attributes of object prototype (such as hasOwnProperty, toString or valueOf). Possible mitigations might be: freezing the object prototype, using an object without prototypes (via Object.create(null) ), blocking modifications of attributes that resolve to object prototype, using Map instead of object.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.lang.security.audit.prototype-pollution.prototype-pollution-loop.prototype-pollution-loop</td><td><div class="data" data-impact="LOW" data-severity="WARNING"><span class='red'>LOW</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/jquery/jquery.js#L17">public/miner/js/jquery/jquery.js</a></td><td>9677</td><td>17</td><td>Possibility of prototype polluting function detected. By adding or modifying attributes of an object prototype, it is possible to create attributes that exist on every object, or replace critical attributes with malicious ones. This can be problematic if the software depends on existence or non-existence of certain attributes, or uses pre-defined attributes of object prototype (such as hasOwnProperty, toString or valueOf). Possible mitigations might be: freezing the object prototype, using an object without prototypes (via Object.create(null) ), blocking modifications of attributes that resolve to object prototype, using Map instead of object.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.browser.security.insecure-document-method.insecure-document-method</td><td><div class="data" data-impact="LOW" data-severity="ERROR"><span class='red'>LOW</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/jquery/jquery.js#L18">public/miner/js/jquery/jquery.js</a></td><td>753</td><td>18</td><td>User controlled data in methods like `innerHTML`, `outerHTML` or `document.write` is an anti-pattern that can lead to XSS vulnerabilities</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/jquery/jquery_ui.js#L330">public/miner/js/jquery/jquery_ui.js</a></td><td>37</td><td>330</td><td>RegExp() called with a `b` function argument, this might allow an attacker to cause a Regular Expression Denial-of-Service (ReDoS) within your application as RegExP blocks the main thread. For this reason, it is recommended to use hardcoded regexes instead. If your regex is run on user-controlled input, consider performing input validation or use a regex checking/sanitization library such as https://www.npmjs.com/package/recheck to verify that the regex does not appear vulnerable to ReDoS.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.browser.security.eval-detected.eval-detected</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/jquery/jquery_ui.js#L490">public/miner/js/jquery/jquery_ui.js</a></td><td>189</td><td>490</td><td>Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>generic.secrets.security.detected-artifactory-password.detected-artifactory-password</td><td><div class="data" data-impact="HIGH" data-severity="ERROR"><span class='red'>HIGH</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/pushbuilder.js#L18">public/miner/js/pushbuilder.js</a></td><td>33</td><td>18</td><td>Artifactory token detected</td><td><pre><code class="language-js">14         model: {
15             platform: 'android',
16             title: 'DANT12',
17             body: 'DANT15',
18             token: 'dMAx39X3-u8:APA91bGXo1pw6BL_2antUQEziMNRjsMP739iUxqPUvzeuJjmelV7kJvmToWd0eKornHvDC4lfYNTgl4ZKnwj2OqwMPLqF7Qc0Auu65tTmDZ7RK4Mfh8L4q_o0sPFs_HolozxnqZpFCNi',
19             delay: 20,
20             playerId: 1234,
21             notificationId: 1,
22             backgroundImage: 'backgroundimage',
23             smallIcon: 'push48',
24             customView: 'customlayout',
</code></pre></td></tr><tr><td>javascript.browser.security.insecure-document-method.insecure-document-method</td><td><div class="data" data-impact="LOW" data-severity="ERROR"><span class='red'>LOW</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/swfobject23.js#L5">public/miner/js/swfobject23.js</a></td><td>371</td><td>5</td><td>User controlled data in methods like `innerHTML`, `outerHTML` or `document.write` is an anti-pattern that can lead to XSS vulnerabilities</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.browser.security.insecure-document-method.insecure-document-method</td><td><div class="data" data-impact="LOW" data-severity="ERROR"><span class='red'>LOW</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/js/swfobject23.js#L5">public/miner/js/swfobject23.js</a></td><td>678</td><td>5</td><td>User controlled data in methods like `innerHTML`, `outerHTML` or `document.write` is an anti-pattern that can lead to XSS vulnerabilities</td><td><pre><code class="language-js">minimized js...</code></pre></td></tr><tr><td>javascript.browser.security.insecure-document-method.insecure-document-method</td><td><div class="data" data-impact="LOW" data-severity="ERROR"><span class='red'>LOW</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/painter/swfobject.js#L386">public/miner/painter/swfobject.js</a></td><td>4</td><td>386</td><td>User controlled data in methods like `innerHTML`, `outerHTML` or `document.write` is an anti-pattern that can lead to XSS vulnerabilities</td><td><pre><code class="language-js">382 
383 	function abstractAltContent(obj) {
384 		var ac = createElement("div");
385 		if (ua.win && ua.ie) {
386 			ac.innerHTML = obj.innerHTML;
387 		}
388 		else {
389 			var nestedObj = obj.getElementsByTagName(OBJECT)[0];
390 			if (nestedObj) {
391 				var c = nestedObj.childNodes;
392 				if (c) {
</code></pre></td></tr><tr><td>javascript.browser.security.insecure-document-method.insecure-document-method</td><td><div class="data" data-impact="LOW" data-severity="ERROR"><span class='red'>LOW</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/public/miner/painter/swfobject.js#L435">public/miner/painter/swfobject.js</a></td><td>5</td><td>435</td><td>User controlled data in methods like `innerHTML`, `outerHTML` or `document.write` is an anti-pattern that can lead to XSS vulnerabilities</td><td><pre><code class="language-js">431 					if (parObj[j] != Object.prototype[j]) { // filter out prototype additions from other potential libraries
432 						par += '<param name="' + j + '" value="' + parObj[j] + '" />';
433 					}
434 				}
435 				el.outerHTML = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"' + att + '>' + par + '</object>';
436 				objIdArr[objIdArr.length] = attObj.id; // stored to fix object 'leaks' on unload (dynamic publishing only)
437 				r = getElementById(attObj.id);	
438 			}
439 			else { // well-behaving browsers
440 				var o = createElement(OBJECT);
441 				o.setAttribute("type", FLASH_MIME_TYPE);
</code></pre></td></tr><tr><td>php.lang.security.phpinfo-use.phpinfo-use</td><td><div class="data" data-impact="MEDIUM" data-severity="ERROR"><span class='red'>MEDIUM</span> / ERROR / MEDIUM</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/_restricted/phpinfo.php#L6">server-diggy/_restricted/phpinfo.php</a></td><td>1</td><td>6</td><td>The 'phpinfo' function may reveal sensitive information about your environment.</td><td><pre><code class="language-php">2 
3 declare(strict_types=1);
4 
5 print '<pre>';
6 phpinfo();
7 print '</pre>';
</code></pre></td></tr><tr><td>generic.secrets.security.detected-generic-api-key.detected-generic-api-key</td><td><div class="data" data-impact="MEDIUM" data-severity="ERROR"><span class='red'>MEDIUM</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/account_reset.php#L18">server-diggy/account_reset.php</a></td><td>10</td><td>18</td><td>Generic API Key detected</td><td><pre><code class="language-php">14 $legacyRequestProvider = \App\Infrastructure\Bridge\Legacy\StaticSymfonyContainer::get(\App\Infrastructure\Bridge\Legacy\LegacySymfonyRequestProvider::class);
15 $legacyRequest = $legacyRequestProvider->provideRequest();
16 
17 // account reset script for chinese UA tester
18 $expectedApiKey = 'g875WLqDpVKjaGfqekpZfEgaB54PGUfb';
19 $receivedApiKey = filter_var($legacyRequest->getFromGet('api_key'), FILTER_SANITIZE_STRING);
20 
21 if ($receivedApiKey !== $expectedApiKey) {
22     echo 'Invalid api key.';
23     return; // exit(1);
24 }
</code></pre></td></tr><tr><td>php.doctrine.security.audit.doctrine-dbal-dangerous-query.doctrine-dbal-dangerous-query</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/core/Db/Database.php#L155">server-diggy/core/Db/Database.php</a></td><td>26</td><td>155</td><td>Detected string concatenation with a non-literal variable in a Doctrine DBAL query method. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead.</td><td><pre><code class="language-php">151         $t_start = microtime(true);
152 
153         // create new PDOStatement
154         try {
155             $statement = $this->connection->prepare($query);
156         } catch (DBALException $e) {
157             $this->status = 'ERROR_DB QUERY_P: ' . $e->getMessage();
158             $this->logError($this->status);
159             $this->logger->error($this->status, [
160                 'exception' => $e,
161             ]);
</code></pre></td></tr><tr><td>php.doctrine.security.audit.doctrine-dbal-dangerous-query.doctrine-dbal-dangerous-query</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/core/Db/Database.php#L166">server-diggy/core/Db/Database.php</a></td><td>23</td><td>166</td><td>Detected string concatenation with a non-literal variable in a Doctrine DBAL query method. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead.</td><td><pre><code class="language-php">162             return false;
163         }
164 
165         try {
166             $result = $statement->executeQuery($params);
167 
168             // update effected rows counter
169             $this->effected_rows = $result->rowCount();
170         } catch (DBALException $e) {
171             $this->status = sprintf(
172                 'ERROR_DB QUERY_E: query: %s, error: %s',
</code></pre></td></tr><tr><td>php.doctrine.security.audit.doctrine-dbal-dangerous-query.doctrine-dbal-dangerous-query</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/core/Db/Database.php#L245">server-diggy/core/Db/Database.php</a></td><td>26</td><td>245</td><td>Detected string concatenation with a non-literal variable in a Doctrine DBAL query method. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead.</td><td><pre><code class="language-php">241         $t_start = microtime(true);
242 
243         // create new PDOStatement
244         try {
245             $statement = $this->connection->prepare($query);
246         } catch (DBALException $e) {
247             $this->status = 'ERROR_DB QUERY_P: ' . $e->getMessage();
248             $this->logError($this->status);
249             $this->logger->error($this->status, [
250                 'exception' => $e,
251             ]);
</code></pre></td></tr><tr><td>php.doctrine.security.audit.doctrine-dbal-dangerous-query.doctrine-dbal-dangerous-query</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/core/Db/Database.php#L262">server-diggy/core/Db/Database.php</a></td><td>27</td><td>262</td><td>Detected string concatenation with a non-literal variable in a Doctrine DBAL query method. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead.</td><td><pre><code class="language-php">258 
259         $params_info = [];
260         foreach ($params as $key => $param_set) {
261             try {
262                 $result = $statement->executeQuery($param_set);
263                 $resultData = $result->fetchAllAssociative();
264             } catch (DBALException $e) {
265                 $this->status = sprintf(
266                     'ERROR_DB QUERY_E: query: %s, error: %s',
267                     $query,
268                     $e->getMessage()
</code></pre></td></tr><tr><td>php.lang.security.eval-use.eval-use</td><td><div class="data" data-impact="HIGH" data-severity="ERROR"><span class='red'>HIGH</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/core/Environment.php#L1726">server-diggy/core/Environment.php</a></td><td>13</td><td>1726</td><td>Evaluating non-constant commands. This can lead to command injection.</td><td><pre><code class="language-php">1722             if (!preg_match('/^[0-9\+\-\*\/\(\) ]+$/', $amount_formula)) {
1723                 throw new ApiException('invalid amount formula "' . $dr_item['amount'] . '" id ' . $dr_item['def_id']);
1724             }
1725 
1726             $compute = eval('return (' . $amount_formula . ');');
1727 
1728             $amount = (int)$compute;
1729 
1730             if ($amount <= 0) {
1731                 throw new ApiException('non positive amount "' . $amount . '" id ' . $dr_item['def_id']);
1732             }
</code></pre></td></tr><tr><td>php.lang.security.eval-use.eval-use</td><td><div class="data" data-impact="HIGH" data-severity="ERROR"><span class='red'>HIGH</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/core/Environment.php#L5138">server-diggy/core/Environment.php</a></td><td>9</td><td>5138</td><td>Evaluating non-constant commands. This can lead to command injection.</td><td><pre><code class="language-php">5134         if (!preg_match('/^[0-9\+\-\*\/\(\) \.]+$/', $amount_formula)) {
5135             throw new \ApiException('invalid amount formula "' . $formula . '"');
5136         }
5137 
5138         $compute = eval('return (' . $amount_formula . ');');
5139 
5140         $amount = (int)$compute;
5141 
5142         if ($amount <= 0) {
5143             throw new ApiException('non positive amount "' . $amount . '"');
5144         }
</code></pre></td></tr><tr><td>php.lang.security.eval-use.eval-use</td><td><div class="data" data-impact="HIGH" data-severity="ERROR"><span class='red'>HIGH</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/core/Sync/Player.php#L1351">server-diggy/core/Sync/Player.php</a></td><td>9</td><td>1351</td><td>Evaluating non-constant commands. This can lead to command injection.</td><td><pre><code class="language-php">1347         if (!preg_match('/^[0-9\+\-\*\/\(\) ]+$/', $amount_formula)) {
1348             throw new ApiException('invalid amount formula "' . $playBonus_def['amount'] . '" id ' . $playBonus_def['def_id']);
1349         }
1350 
1351         $compute = eval('return (' . $amount_formula . ');');
1352 
1353         $amount = (int)$compute;
1354 
1355         if ($amount <= 0) {
1356             throw new ApiException('non positive amount "' . $amount . '" id ' . $playBonus_def['def_id']);
1357         }
</code></pre></td></tr><tr><td>php.lang.security.eval-use.eval-use</td><td><div class="data" data-impact="HIGH" data-severity="ERROR"><span class='red'>HIGH</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/core/Sync/Player.php#L1620">server-diggy/core/Sync/Player.php</a></td><td>13</td><td>1620</td><td>Evaluating non-constant commands. This can lead to command injection.</td><td><pre><code class="language-php">1616             if (!preg_match('/^[0-9\+\-\*\/\(\) ]+$/', $amount_formula)) {
1617                 throw new ApiException('invalid amount formula "' . $daily_reward_segmented_item['amount'] . '" id ' . $dr_item['def_id']);
1618             }
1619 
1620             $compute = eval('return (' . $amount_formula . ');');
1621 
1622             $amount = (int)$compute;
1623 
1624             if ($amount <= 0) {
1625                 throw new ApiException('non positive amount "' . $amount . '" id ' . $dr_item['def_id']);
1626             }
</code></pre></td></tr><tr><td>php.lang.security.eval-use.eval-use</td><td><div class="data" data-impact="HIGH" data-severity="ERROR"><span class='red'>HIGH</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/core/Sync/Player.php#L1679">server-diggy/core/Sync/Player.php</a></td><td>9</td><td>1679</td><td>Evaluating non-constant commands. This can lead to command injection.</td><td><pre><code class="language-php">1675         if (!preg_match('/^[0-9\+\-\*\/\(\) ]+$/', $amount_formula)) {
1676             throw new ApiException('invalid amount formula "' . $vr_reward . '"');
1677         }
1678 
1679         $compute = eval('return (' . $amount_formula . ');');
1680 
1681         $amount = (int)$compute;
1682 
1683         if ($amount <= 0) {
1684             throw new ApiException('non positive amount "' . $amount . '"');
1685         }
</code></pre></td></tr><tr><td>php.lang.security.curl-ssl-verifypeer-off.curl-ssl-verifypeer-off</td><td><div class="data" data-impact="LOW" data-severity="ERROR"><span class='red'>LOW</span> / ERROR / MEDIUM</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/core/Utils.php#L553">server-diggy/core/Utils.php</a></td><td>9</td><td>553</td><td>SSL verification is disabled but should not be (currently CURLOPT_SSL_VERIFYPEER= false)</td><td><pre><code class="language-php">549       curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
550       curl_setopt($ch, CURLOPT_HTTPHEADER, array("Expect:"));
551 
552       if ($ssl) {
553         curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
554         curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
555       }
556 
557       if ($method == 'delete') {
558         curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'DELETE');
559       }
</code></pre></td></tr><tr><td>generic.secrets.security.detected-generic-api-key.detected-generic-api-key</td><td><div class="data" data-impact="MEDIUM" data-severity="ERROR"><span class='red'>MEDIUM</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/integration_status_check.php#L23">server-diggy/integration_status_check.php</a></td><td>10</td><td>23</td><td>Generic API Key detected</td><td><pre><code class="language-php">19 
20 /** @var \App\Infrastructure\Service\Response\LegacyHeaders $legacyHeaders */
21 $legacyHeaders = \App\Infrastructure\Bridge\Legacy\StaticSymfonyContainer::get(\App\Infrastructure\Service\Response\LegacyHeaders::class);
22 
23 $expectedApiKey = 'g875WLqDpVKjaGfqekpZfEgaB54PGUfb';
24 $receivedApiKey = filter_var($legacyRequest->getFromGet('api_key'), FILTER_SANITIZE_STRING);
25 
26 if ($receivedApiKey !== $expectedApiKey) {
27     echo sprintf('Invalid api key. Received %s', $receivedApiKey);
28     return; // exit(1);
29 }
</code></pre></td></tr><tr><td>generic.secrets.security.detected-generic-api-key.detected-generic-api-key</td><td><div class="data" data-impact="MEDIUM" data-severity="ERROR"><span class='red'>MEDIUM</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/server-diggy/jump_to_quest.php#L15">server-diggy/jump_to_quest.php</a></td><td>10</td><td>15</td><td>Generic API Key detected</td><td><pre><code class="language-php">11 $legacyRequestProvider = \App\Infrastructure\Bridge\Legacy\StaticSymfonyContainer::get(\App\Infrastructure\Bridge\Legacy\LegacySymfonyRequestProvider::class);
12 $legacyRequest = $legacyRequestProvider->provideRequest();
13 
14 // account reset script for chinese UA tester
15 $expectedApiKey = 'g875WLqDpVKjaGfqekpZfEgaB54PGUfb';
16 $receivedApiKey = filter_var($legacyRequest->getFromGet('api_key'), FILTER_SANITIZE_STRING);
17 
18 if ($receivedApiKey !== $expectedApiKey) {
19     echo sprintf('Invalid api key. Received %s', $receivedApiKey);
20     return; // exit(1);
21 }
</code></pre></td></tr><tr><td>php.doctrine.security.audit.doctrine-dbal-dangerous-query.doctrine-dbal-dangerous-query</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/src/Application/Console/Cron/TeamFixer.php#L112">src/Application/Console/Cron/TeamFixer.php</a></td><td>33</td><td>112</td><td>Detected string concatenation with a non-literal variable in a Doctrine DBAL query method. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead.</td><td><pre><code class="language-php">108     private function executeTeamFixer(int $limit): int
109     {
110         $executed = 0;
111 
112         $brokenTeamsStatement = $this->connection->prepare(sprintf(self::BROKEN_TEAMS_SQL, $limit));
113         $brokenTeams = $brokenTeamsStatement->executeQuery(['team_member_limit' => $this->getMemberLimit()]);
114         $processedTeams = [];
115 
116         foreach ($brokenTeams->iterateAssociative() as $item) {
117             $leaderPlayerId = (int)$item['player_id'];
118             $teamId = (int)$item['team_id'];
</code></pre></td></tr><tr><td>php.doctrine.security.audit.doctrine-dbal-dangerous-query.doctrine-dbal-dangerous-query</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/src/Application/Console/Cron/TeamFixer.php#L113">src/Application/Console/Cron/TeamFixer.php</a></td><td>24</td><td>113</td><td>Detected string concatenation with a non-literal variable in a Doctrine DBAL query method. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead.</td><td><pre><code class="language-php">109     {
110         $executed = 0;
111 
112         $brokenTeamsStatement = $this->connection->prepare(sprintf(self::BROKEN_TEAMS_SQL, $limit));
113         $brokenTeams = $brokenTeamsStatement->executeQuery(['team_member_limit' => $this->getMemberLimit()]);
114         $processedTeams = [];
115 
116         foreach ($brokenTeams->iterateAssociative() as $item) {
117             $leaderPlayerId = (int)$item['player_id'];
118             $teamId = (int)$item['team_id'];
119             $countOfExtraPlayers = (int)$item['team_members_count'] - $this->getMemberLimit();
</code></pre></td></tr><tr><td>php.lang.security.eval-use.eval-use</td><td><div class="data" data-impact="HIGH" data-severity="ERROR"><span class='red'>HIGH</span> / ERROR / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/src/Domain/Model/RandomReward/Value/FormulaAmount.php#L25">src/Domain/Model/RandomReward/Value/FormulaAmount.php</a></td><td>9</td><td>25</td><td>Evaluating non-constant commands. This can lead to command injection.</td><td><pre><code class="language-php">21         if (!preg_match('/^[0-9\+\-\*\/\(\) \.]+$/', $formulaString)) {
22             throw CannotTransformRandomReward::invalidFormula($formula);
23         }
24 
25         $amount = (int)eval('return (' . $formulaString . ');');
26 
27         if ($amount <= 0) {
28             throw CannotTransformRandomReward::nonPositiveFormulaResult($formula, $level);
29         }
30 
31         return new self($amount);
</code></pre></td></tr><tr><td>php.doctrine.security.audit.doctrine-dbal-dangerous-query.doctrine-dbal-dangerous-query</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/src/Infrastructure/Definition/Legacy/Storage/FileFinder/DefinitionsDatabaseFileFinder.php#L41">src/Infrastructure/Definition/Legacy/Storage/FileFinder/DefinitionsDatabaseFileFinder.php</a></td><td>18</td><td>41</td><td>Detected string concatenation with a non-literal variable in a Doctrine DBAL query method. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead.</td><td><pre><code class="language-php">37     }
38 
39     private function getFilesByPrefix(string $prefix): array
40     {
41         $files = $this->database->executeQuery(
42             sprintf(self::SEARCH_DEFINITIONS_SQL, $this->versionTable->value),
43             ['prefix' => $prefix . '%'],
44         )->fetchFirstColumn();
45 
46         return array_map(
47             fn (string $file): string => $this->makeFullPath($file),
</code></pre></td></tr><tr><td>php.doctrine.security.audit.doctrine-dbal-dangerous-query.doctrine-dbal-dangerous-query</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/src/Infrastructure/Definition/Storage/Stream/DefinitionStream.php#L28">src/Infrastructure/Definition/Storage/Stream/DefinitionStream.php</a></td><td>24</td><td>28</td><td>Detected string concatenation with a non-literal variable in a Doctrine DBAL query method. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead.</td><td><pre><code class="language-php">24     {
25         try {
26             $pathParts = new Path($path, self::STREAM_NAME, self::$staticPath);
27 
28             $content = self::$connection->executeQuery(
29                 sprintf(self::SELECT_SQL, $pathParts->versionTable->value),
30                 ['path' => $pathParts->normalizedPath],
31             )->fetchOne();
32 
33             if ($content === false) {
34                 throw new RuntimeException(
</code></pre></td></tr><tr><td>php.symfony.security.audit.symfony-permissive-cors.symfony-permissive-cors</td><td><div class="data" data-impact="MEDIUM" data-severity="WARNING"><span class='red'>MEDIUM</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/src/Infrastructure/Service/Response/CorsHeaderListener.php#L72">src/Infrastructure/Service/Response/CorsHeaderListener.php</a></td><td>9</td><td>72</td><td>Access-Control-Allow-Origin response header is set to "*". This will disable CORS Same Origin Policy restrictions.</td><td><pre><code class="language-php">68         }
69 
70         $response = $event->getResponse();
71 
72         $response->headers->set("Access-Control-Allow-Origin","*");
73     }
74 
75     private function isAllowed(KernelEvent $event): bool
76     {
77         return $event->isMainRequest();
78     }
</code></pre></td></tr><tr><td>php.doctrine.security.audit.doctrine-dbal-dangerous-query.doctrine-dbal-dangerous-query</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/src/Infrastructure/Tool/CopyPlayer/Service/CopyPlayerService.php#L130">src/Infrastructure/Tool/CopyPlayer/Service/CopyPlayerService.php</a></td><td>9</td><td>130</td><td>Detected string concatenation with a non-literal variable in a Doctrine DBAL query method. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead.</td><td><pre><code class="language-php">126     }
127 
128     public function createPlayer(string $deleteQuery, string $insertQuery): void
129     {
130         $this->defaultConnection->prepare($deleteQuery)->executeQuery();
131         $this->defaultConnection->prepare($insertQuery)->executeQuery();
132     }
133 
134     private function getPlayerRelatedTables(): array
135     {
136         return $this->readerConnection->prepare(
</code></pre></td></tr><tr><td>php.doctrine.security.audit.doctrine-dbal-dangerous-query.doctrine-dbal-dangerous-query</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/src/Infrastructure/Tool/CopyPlayer/Service/CopyPlayerService.php#L131">src/Infrastructure/Tool/CopyPlayer/Service/CopyPlayerService.php</a></td><td>9</td><td>131</td><td>Detected string concatenation with a non-literal variable in a Doctrine DBAL query method. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead.</td><td><pre><code class="language-php">127 
128     public function createPlayer(string $deleteQuery, string $insertQuery): void
129     {
130         $this->defaultConnection->prepare($deleteQuery)->executeQuery();
131         $this->defaultConnection->prepare($insertQuery)->executeQuery();
132     }
133 
134     private function getPlayerRelatedTables(): array
135     {
136         return $this->readerConnection->prepare(
137             "SELECT TABLE_NAME as tname FROM `information_schema`.`COLUMNS` WHERE COLUMN_NAME = 'player_id' AND TABLE_NAME NOT IN ('transactions_b', 'devices', 'stats_gems_gain');",
</code></pre></td></tr><tr><td>php.doctrine.security.audit.doctrine-dbal-dangerous-query.doctrine-dbal-dangerous-query</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/src/Infrastructure/Tool/CopyPlayer/Service/CopyPlayerService.php#L22">src/Infrastructure/Tool/CopyPlayer/Service/CopyPlayerService.php</a></td><td>38</td><td>22</td><td>Detected string concatenation with a non-literal variable in a Doctrine DBAL query method. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead.</td><td><pre><code class="language-php">18         $data = [];
19         $tables = $this->getPlayerRelatedTables();
20 
21         foreach ($tables as $table) {
22             $data[$table['tname']] = $this->readerConnection->prepare("SELECT * FROM `{$table['tname']}` WHERE player_id = :playerId ;")
23                 ->executeQuery(['playerId' => $playerId])
24                 ->fetchAllAssociative();
25 
26             if ($table['tname'] === 'cities' || $table['tname'] === 'locations') {
27                 foreach($data[$table['tname']] as $key => $row) {
28                     $data[$table['tname']][$key]['map'] = bin2hex($row['map']);
</code></pre></td></tr><tr><td>php.doctrine.security.audit.doctrine-dbal-dangerous-query.doctrine-dbal-dangerous-query</td><td><div class="data" data-impact="HIGH" data-severity="WARNING"><span class='red'>HIGH</span> / WARNING / LOW</div></td><td><a target="_blank" href="https://github.com/pxfd/Server.DiggysAdventure/blob/4771fb4276b92995f20547e7cd81993bd71b8c89/src/Infrastructure/Tool/CopyPlayer/Service/CopyPlayerService.php#L44">src/Infrastructure/Tool/CopyPlayer/Service/CopyPlayerService.php</a></td><td>21</td><td>44</td><td>Detected string concatenation with a non-literal variable in a Doctrine DBAL query method. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead.</td><td><pre><code class="language-php">40     }
41 
42     public function checkIfPlayerExists(int $playerId): bool
43     {
44         $playerId = $this->readerConnection->prepare("SELECT player_id FROM players WHERE player_id = :playerId;")
45             ->executeQuery(['playerId' => $playerId])
46             ->fetchOne();
47 
48         return $playerId !== null;
49     }
50 
</code></pre></td></tr></tbody></table>
                </body>
                <script>hljs.highlightAll();
                document.addEventListener('DOMContentLoaded', (event) => { main() })
                </script>
            </html>